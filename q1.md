1 - Consideran que la empresa XYZ solicita realizar una página web que soporte 10000 usuarios concurrentes con grabación de registro en base de datos PostgreSQL, envío de email de confirmación e informe a API de CRM con menos de 100 req/s. Indicar una solución tecnológica óptima para este problema en la nube e incluir un documento de solución junto con los frameworks seleccionados y los motivos haciendo hincapié en la performance y menor costo de implementación tanto en horas como dinero.

## Diagrama de arquitectura

![Architecture Diagram](https://github.com/raulbajales/nybble/blob/main/q1-diagram.png?raw=true)

## Componentes, tecnologias y responsabilidades

### Client

Es el cliente WEB servido por la app Web BFF.

### ALB

AWS managed load balancer permite balancear la carga de requests del cliente y redirigirlo a los pods disponibles dentro del cluster kubernetes.

### AWS Managed Kubernetes Cluster

Permite escalar horizonalmente los servicios corriendo dentro de este cluster para soportar picos de requests de usuarios.

### WEB BFF

App que sirve el FE WEB para el cliente e interacciona con BE API and API Services para resolver los requests del usuario.

Tecnologias:

- NodeJS (NextJS, Angular, etc)
- Mantiene JWT token del usuario ologeado en cookie del cliente y lo usa como parte del Authorization header para subsiguientes requests al BE API and API Services

Reponsabilidades:

- Servir el cliente web
- recibir requests del cliente web y delegarlos al BE

### BE API and API Services

Tecnologias:

- SpringBoot

Responsabilidades:

- Resolver requests del BFF
- Autenticar al usuario
  - Recibiendo usuario y password autentica al usuario guardado en BD (password hashing)
  - Genera JWT token (con rol del user en la metadata, y expiracion) y lo envia al BFF para que lo devuelva al cliente y este lo mantenga en cookies para susecivos requests
- Autorizar al usuario: Validar si un user tiene un rol que le permita una determinada accion sobre un recurso dado
- Capa de acceso a datos (Postgres SQL)
- Capa de acceso a la cola de mensajes (SQS) para encolar tareas como enviar emails y uso de webhook / hit API CRM
- Consumir mensajes de la cola para enail emails y uso de webhook / hit API CRM

Consideraciones:

- Podria implementarse como monolito o como una serie de microservicios, este ultimo approach tiene la ventaja de que cada microservicio podria escalar horizontalmente a demanda por servicio (en vez de escalar el monolito completo) y los microservicios que se podrian considerar podrian tener responsabilidades cohesivas
  - AuthZ
    - Generar y refrescar JWT token
    - Autorizacion: Validar si un user tiene un rol que le permita una determinada accion sobre un recurso dado
  - CRMIntegration
  - EmailSender
